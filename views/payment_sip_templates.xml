<?xml version="1.0" encoding="utf-8"?>
<odoo>

    <template id="token_form" inherit_id="payment.token_form">
        <xpath expr="//t[@t-set='hide_secured_by']" position="attributes">
            <attribute name="t-value" separator=" " add="or provider_sudo.code == 'sip'"/>
        </xpath>
    </template>

    <template id="payment_method_form" inherit_id="payment.method_form">
        <xpath expr="//t[@t-set='hide_secured_by']" position="attributes">
            <attribute name="t-value" separator=" " add="or provider_sudo.code == 'sip'"/>
        </xpath>
    </template>

    <template id="redirect_form">
        <form t-att-action="api_url" method="post">
            <input type="hidden" name="sip_qr" t-att-value="sip_qr"/>
        </form>
    </template>

    <template id="sip_state_header" inherit_id="payment.state_header">

        <xpath expr="//div[@id='o_payment_status_message']" position="inside">
            <t t-if="tx.provider_id.sudo().code == 'sip'">
                <div class="d-flex justify-content-center mt-3">
                    <div class="card shadow-sm">
                        <div class="card-body p-2">
                            <img t-att-src="image_data_uri(tx.sip_qr_id.qr_image)"
                                 class="img-fluid"
                                 style="max-width:420px; object-fit:contain;"/>
                        </div>
                    </div>
                </div>
                <small class="d-block mt-2 text-center">
                    Scan me in your banking app
                </small>
            </t>
        </xpath>

        <xpath expr="//div[@name='o_payment_status_alert']" position="attributes">
            <attribute name="class" remove="d-flex" add="flex-grow-0"/>
        </xpath>

    </template>

</odoo>